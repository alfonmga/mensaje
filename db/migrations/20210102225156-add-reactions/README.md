# Migration `20210102225156-add-reactions`

This migration has been generated by Gabriel Chertok at 1/2/2021, 7:51:56 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Reaction" (
    "id" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "emoji" TEXT NOT NULL,
    "alt" TEXT NOT NULL,
    "userId" TEXT,
    "messageId" TEXT,

    PRIMARY KEY ("id")
)

ALTER TABLE "Reaction" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Reaction" ADD FOREIGN KEY("messageId")REFERENCES "Message"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210101233226-make-user-optional-on-message..20210102225156-add-reactions
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -12,17 +12,18 @@
 // --------------------------------------
 model User {
-  id             String    @id @default(uuid())
-  createdAt      DateTime  @default(now())
-  updatedAt      DateTime  @updatedAt
+  id             String     @id @default(uuid())
+  createdAt      DateTime   @default(now())
+  updatedAt      DateTime   @updatedAt
   name           String?
-  email          String    @unique
+  email          String     @unique
   hashedPassword String?
-  role           String    @default("user")
+  role           String     @default("user")
   sessions       Session[]
   messages       Message[]
+  reactions      Reaction[]
 }
 model Session {
   id                 String    @id @default(uuid())
@@ -38,13 +39,26 @@
   privateData        String?
 }
 model Message {
-  id             String   @id @default(uuid())
-  createdAt      DateTime @default(now())
-  updatedAt      DateTime @updatedAt
+  id             String     @id @default(uuid())
+  createdAt      DateTime   @default(now())
+  updatedAt      DateTime   @updatedAt
   title          String
   body           String
-  user           User?    @relation(fields: [userId], references: [id])
+  user           User?      @relation(fields: [userId], references: [id])
   userId         String?
   slackChannelId String
+  reactions      Reaction[]
 }
+
+model Reaction {
+  id        String   @id @default(uuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  emoji     String
+  alt       String
+  user      User?    @relation(fields: [userId], references: [id])
+  userId    String?
+  message   Message? @relation(fields: [messageId], references: [id])
+  messageId String?
+}
```


